var I=Object.defineProperty;var L=(n,t,e)=>t in n?I(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var i=(n,t,e)=>(L(n,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function e(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(r){if(r.ep)return;r.ep=!0;const s=e(r);fetch(r.href,s)}})();const d={CANVAS_WIDTH:600,CANVAS_HEIGHT:650},h=d.CANVAS_WIDTH/3,o=50,S=100,m=3,g=50,u=100,w=800,v=1500,p=250;class H{constructor(t,e,a){i(this,"ctx");i(this,"canvas");i(this,"laneHeight");i(this,"speed");this.ctx=t,this.canvas=e,this.laneHeight=0,this.speed=a}draw(){this.ctx.fillStyle="#474747",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height);const t=10,e=20,a=30;this.ctx.fillStyle="white";for(let r=1;r<m;r++){const s=r*h-t/2;for(let c=-a;c<this.canvas.height;c+=a+e)this.ctx.fillRect(s,c+this.laneHeight,t,a)}}update(){this.laneHeight+=this.speed,this.laneHeight>=50&&(this.laneHeight=0)}setSpeed(t){this.speed=t}}class T{constructor(t,e,a){i(this,"ctx");i(this,"lane");i(this,"x");i(this,"y");i(this,"targetLane");i(this,"animationProgress");i(this,"animationSpeed");i(this,"isAnimating");i(this,"img");this.ctx=t,this.lane=e,this.x=e*h+(h-o)/2,this.y=d.CANVAS_HEIGHT-S-20,this.targetLane=e,this.animationProgress=0,this.animationSpeed=.1,this.isAnimating=!1,this.img=new Image,this.img.src=a}drawCar(){this.isAnimating&&this.updateAnimation(),this.ctx.drawImage(this.img,59,260,150,284,this.x,this.y,o,S)}updateAnimation(){const t=this.lane*h+(h-o)/2,e=this.targetLane*h+(h-o)/2;this.x=t+(e-t)*this.animationProgress,this.animationProgress+=this.animationSpeed,this.animationProgress>=1&&(this.animationProgress=0,this.lane=this.targetLane,this.isAnimating=!1)}moveLeft(){this.lane>0&&(this.targetLane=this.lane-1,this.x=this.lane*h+(h-o)/2,this.isAnimating=!0)}moveRight(){this.lane<m-1&&(this.targetLane=this.lane+1,this.x=this.lane*h+(h-o)/2,this.isAnimating=!0)}}class E{constructor(t,e,a,r){i(this,"ctx");i(this,"lane");i(this,"x");i(this,"y");i(this,"speed");i(this,"img");this.ctx=t,this.lane=e,this.x=e*h+(h-g)/2,this.y=-u,this.speed=a,this.img=new Image,this.img.src=r}draw(){this.ctx.drawImage(this.img,407,260,150,284,this.x,this.y,g,u)}update(){this.y+=this.speed}isOffScreen(){return this.y>d.CANVAS_HEIGHT}drawScore(){this.ctx.fillStyle="white",this.ctx.font="14px Arial",this.ctx.fillText("+10",this.x+g/2-10,this.y-10)}setSpeed(t){this.speed=t}}function x(n,t){const e=Math.ceil(n),a=Math.floor(t);return Math.floor(Math.random()*(a-e)+e)}class O{constructor(t,e,a){i(this,"ctx");i(this,"score");i(this,"highScore");i(this,"onScoreIncrement");this.ctx=t,this.score=0,this.highScore=a,this.onScoreIncrement=e}increment(){this.score+=10,this.onScoreIncrement()}draw(){this.ctx.fillStyle="white",this.ctx.font="20px Arial",this.ctx.fillText(`Score: ${this.score}`,10,30),this.ctx.fillStyle="white",this.ctx.font="22px Arial",this.ctx.fillText(`High Score : ${this.highScore}`,10,60)}}class _{constructor(t,e,a){i(this,"canvas");i(this,"ctx");i(this,"highway");i(this,"playerCar");i(this,"score");i(this,"obstacles",[]);i(this,"lastObstacleTime",0);i(this,"lastSpawnTime",0);i(this,"speed",2);i(this,"highScore");this.canvas=t,this.ctx=e,this.highway=new H(e,t,this.speed),this.playerCar=new T(e,1,"Images/Car-Sprite.png"),this.score=new O(e,this.incrementSpeed.bind(this),a),this.highScore=a}incrementSpeed(){this.speed+=.3,this.highway.setSpeed(this.speed),this.obstacles.forEach(t=>t.setSpeed(this.speed))}draw(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.highway.draw(),this.highway.update(),this.playerCar.drawCar();const t=performance.now();t-this.lastObstacleTime>x(w,v)&&(this.generateObstacle(),this.lastObstacleTime=t),this.obstacles.forEach((e,a)=>{e.update(),e.draw(),e.isOffScreen()&&(this.obstacles.splice(a,1),this.score.increment()),this.isCollision(this.playerCar,e)&&this.gameOver(),e.drawScore()}),this.score.draw(),requestAnimationFrame(this.draw.bind(this))}generateObstacle(){const t=performance.now();if(t-this.lastSpawnTime<w)return;const e=Array(m).fill(!0);this.obstacles.forEach(s=>{s.y<p&&(e[s.lane]=!1)});const r=e.map((s,c)=>s?c:-1).filter(s=>s!==-1).filter(s=>{const c=s===0||e[s-1]&&this.obstacles.every(l=>l.lane!==s-1||l.y>=p),C=s===m-1||e[s+1]&&this.obstacles.every(l=>l.lane!==s+1||l.y>=p);return c&&C});if(r.length>0){const s=r[x(0,r.length)];this.obstacles.push(new E(this.ctx,s,this.speed,"Images/Car-Sprite.png")),this.lastSpawnTime=t}}isCollision(t,e){return t.x<e.x+g&&t.x+o>e.x&&t.y<e.y+u&&t.y+S>e.y}gameOver(){this.score.score>this.highScore&&(this.highScore=this.score.score,localStorage.setItem("highScore",this.highScore.toString())),alert(`Game Over! Your Final Score is ${this.score.score}. High Score : ${this.highScore}`),window.location.reload()}start(){requestAnimationFrame(this.draw.bind(this))}}const f=document.querySelector("#gameCanvas"),N=document.querySelector(".game-container"),R=f.getContext("2d"),A=document.querySelector("#startButton");f.height=d.CANVAS_HEIGHT;f.width=d.CANVAS_WIDTH;let b=parseInt(localStorage.getItem("highScore")||"0",10);const y=new _(f,R,b);function P(){A.style.display="none",N.style.display="flex",y.start()}A.addEventListener("click",P);window.addEventListener("keydown",n=>{switch(n.key){case"ArrowLeft":y.playerCar.moveLeft();break;case"ArrowRight":y.playerCar.moveRight();break}});
